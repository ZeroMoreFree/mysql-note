# 基于成本的优化

## 什么是成本

- `I/O`成本：数据从磁盘到内存这个加载的过程损耗的时间
- `CPU`成本：读取以及检测记录是否满足对应的搜索条件、对结果集进行排序等这些操作损耗的时间
- `成本常数`：读取一个页面花费的成本默认是`1.0`，读取以及检测一条记录是否符合搜索条件的成本默认是`0.2`

## 单表查询的成本

- 基于成本的优化步骤（也是`执行计划`生成的过程）
  - 根据搜索条件，找出所有可能使用的索引
  - 计算全表扫描的代价
  - 计算使用不同索引执行查询的代价
  - 对比各种执行方案的代价，找出成本最低的那一个
- 一个查询中可能使用到的索引称之为`possible keys`

## 连接查询的成本

- 对于两表连接查询来说，它的查询成本由下边两个部分构成
  - 单次查询驱动表的成本
  - 多次查询被驱动表的成本（**具体查询多少次取决于对驱动表查询的结果集中有多少条记录**）
- 连接查询总成本 = 单次访问驱动表的成本 + 驱动表扇出数 x 单次访问被驱动表的成本
- 实际建议：**尽量在被驱动表的连接列上建立索引**

## 调节成本常数

- `server`层的成本常数被存储在mysql.server_cost表中
- 存储引擎层的成本常数被存储在mysql.engine_cost表中
