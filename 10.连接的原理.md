# 连接的原理

## 连接简介

### 连接的本质和过程简介

- 连接的本质就是把各个连接表中的记录都取出来依次匹配的组合加入结果集并返回给用户
- 不加任何条件的连接查询产生的结果集是`笛卡尔积`
- 在连接查询中，第一个需要查询的表叫做`驱动表`，其他的表称为`被驱动表`
- 在两表连接查询中，驱动表只需要访问一次，被驱动表可能被访问多次

### 连接的类型

- `内连接`：驱动表中的记录在被驱动表中找不到匹配的记录，该记录不会加入到最后的结果集
- `外连接`：驱动表中的记录即使在被驱动表中没有匹配的记录，也仍然需要加入到结果集
  - 左外连接：选取左侧的表为驱动表
  - 右外连接：选取右侧的表为驱动表
- 在内连接中ON子句和WHERE子句是`等价`的，所以内连接中不要求强制写明ON子句

## 连接的原理

- `嵌套循环连接`：驱动表只访问一次，但被驱动表却可能被多次访问，访问次数取决于对驱动表执行单表查询后的结果集中的记录条数
- 使用索引加快连接速度
- 基于块的嵌套循环连接

![基于块的嵌套循环连接](https://user-gold-cdn.xitu.io/2018/12/25/167e43ab3e5fa2f6?imageslim)

## 注意事项

- `where`子句和`on`子句的区别

>`where`子句不论是内连接还是外连接，凡是不符合WHERE子句中的过滤条件的记录都不会被加入最后的结果集  
对于外连接的驱动表的记录来说，如果无法在被驱动表中找到匹配`ON`子句中的过滤条件的记录，那么该记录仍然会被加入到结果集中，对应的被驱动表记录的各个字段使用`NULL`值填充